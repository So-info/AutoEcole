<!DOCTYPE html>
<html lang="fr" data-theme="auto">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0b1220" />
  <title>Auto √âcole Nounours ‚Äì Accueil</title>
  <meta name="description" content="Pr√©parez votre permis moto avec Auto √âcole Nounours : examen blanc, entra√Ænement guid√©, stats en direct, et reprise instantan√©e.">
  <style>
    :root{
      --bg:#0b1220; --bg-soft:#0e1628; --card:#0f192e; --card-2:#0e172a; --text:#e5e7eb; --muted:#9ca3af; --line:rgba(255,255,255,.08);
      --brand:#f59e0b; --brand-2:#f97316; --accent:var(--brand); --accent-2:var(--brand-2);
      --ok:#22c55e; --warn:#f59e0b; --bad:#ef4444;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial;color:var(--text);
      background:
        radial-gradient(1200px 800px at 70% -10%, color-mix(in oklab, var(--bg) 80%, #172036) 0%, transparent 40%),
        radial-gradient(900px 600px at -10% 120%, color-mix(in oklab, var(--bg) 90%, #0b1220) 0%, transparent 50%),
        linear-gradient(180deg, var(--bg) 0%, var(--bg-soft) 100%);
      -webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;overflow-x:hidden;
    }
    body::before{content:"";position:fixed;inset:0;pointer-events:none;opacity:.05;mix-blend-mode:soft-light;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='140' height='140'%3E%3Cfilter id='n'%3E%3CfeTurbulence baseFrequency='.75' numOctaves='2'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");}

    .container{max-width:1080px;margin:0 auto;padding:20px}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:20px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:48px;height:48px;display:grid;place-items:center;border-radius:14px;
      background:conic-gradient(from 210deg at 50% 50%, color-mix(in oklab, var(--accent) 70%, transparent), color-mix(in oklab, var(--accent-2) 70%, transparent));
      box-shadow:0 8px 30px rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.25);font-size:24px}
    .title{font-size:clamp(22px,5vw,36px);font-weight:900;line-height:1.05;letter-spacing:.2px}
    .subtitle{color:var(--muted);font-size:14px}

    .top-actions{display:flex;align-items:center;gap:10px}
    .switch{--s:34px; position:relative;width:calc(var(--s)*1.7);height:var(--s);border-radius:999px;cursor:pointer;
      border:1px solid var(--line); background:linear-gradient(180deg, var(--card), var(--card-2));
      box-shadow:inset 0 1px 0 rgba(255,255,255,.08)}
    .switch .knob{position:absolute;inset:3px auto 3px 3px;width:calc(var(--s)-6px);aspect-ratio:1;border-radius:50%;
      background:radial-gradient(circle at 70% 30%, rgba(255,255,255,.35), rgba(255,255,255,.05)), linear-gradient(180deg, #1b263d, #0b1428);
      box-shadow:0 6px 20px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.25);
      transition:transform .2s cubic-bezier(.2,.8,.2,1)}
    .switch[data-on="1"] .knob{ transform:translateX(calc(var(--s)*.7)) }
    .switch-label{font-weight:700}

    .hero{position:relative;display:grid;gap:14px;margin:12px 0 20px;padding:18px;border-radius:18px;border:1px solid var(--line);
      background:
        linear-gradient(180deg, rgba(255,255,255,.035), rgba(255,255,255,.02)),
        linear-gradient(180deg, var(--card), var(--card-2));
      isolation:isolate;overflow:hidden}
    .hero h1{margin:0;font-size:clamp(20px,3.2vw,28px)}
    .accent-underline{height:3px;border-radius:6px;width:0;background:linear-gradient(90deg, var(--accent), var(--accent-2));transition:width .7s cubic-bezier(.2,.8,.2,1)}
    .hero .bgfx{position:absolute;inset:-10% -20% auto -20%;height:220px;filter:blur(28px);opacity:.6;pointer-events:none;
      background:radial-gradient(700px 180px at 50% 0%, color-mix(in oklab, var(--accent) 18%, transparent), transparent 55%)}

    .cards{display:grid;gap:12px}
    @media (min-width:780px){ .cards{grid-template-columns:1fr 1fr} }

    .card{position:relative;background:
        linear-gradient(180deg, rgba(255,255,255,.035), rgba(255,255,255,.02)),
        linear-gradient(180deg, var(--card), var(--card-2));
      border:1px solid var(--line);border-radius:18px;box-shadow:0 8px 30px rgba(0,0,0,.12), inset 0 1px 0 rgba(255,255,255,.02);
      overflow:hidden;isolation:isolate;transition:transform .18s ease, box-shadow .18s ease, border-color .18s ease}
    .card:hover{ transform:translateY(-2px) }
    .card::before{content:"";position:absolute;inset:0;border-radius:inherit;padding:1px;background:
        linear-gradient(120deg, rgba(255,255,255,.08), rgba(255,255,255,.02) 40%, rgba(255,255,255,.08));
      -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      -webkit-mask-composite:xor; mask-composite:exclude; pointer-events:none; opacity:.6}
    .tilt{transform-style:preserve-3d; perspective:800px}

    .panel{padding:16px}
    .toolbar{display:flex;gap:12px;align-items:center;justify-content:center;flex-wrap:wrap}

    .btn{display:inline-flex;align-items:center;justify-content:center;gap:10px;cursor:pointer;position:relative;overflow:hidden;
      min-height:44px;padding:12px 16px;font-weight:800;letter-spacing:.2px;border-radius:14px;border:1px solid var(--line);
      background:linear-gradient(180deg, color-mix(in oklab, var(--card) 85%, transparent), color-mix(in oklab, var(--card-2) 85%, transparent));
      color:var(--text);box-shadow:0 6px 24px rgba(0,0,0,.16), inset 0 1px 0 rgba(255,255,255,.06);
      transition: transform .15s ease, box-shadow .15s ease, border-color .15s ease}
    .btn:hover{transform:translateY(-1px)}
    .btn:focus-visible{ outline:2px solid color-mix(in oklab, var(--accent) 45%, transparent); outline-offset:2px }
    .btn-primary{border-color: color-mix(in oklab, var(--accent) 45%, transparent);
      background:linear-gradient(180deg, color-mix(in oklab, var(--accent) 60%, transparent), color-mix(in oklab, var(--accent-2) 45%, transparent));
      box-shadow:0 10px 30px color-mix(in oklab, var(--accent) 28%, transparent), inset 0 1px 0 rgba(255,255,255,.25)}
    .btn-lg{min-height:52px;padding:14px 20px;border-radius:16px}

    .pill{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.06);border:1px solid var(--line);font-weight:700;font-size:12px;color:var(--text)}
    .ok{ color:var(--ok) } .warn{ color:var(--warn) } .muted{ color:var(--muted) }

    .features{display:flex;flex-wrap:wrap;gap:8px;margin-top:6px}

    .stats{display:flex;gap:12px;flex-wrap:wrap;margin-top:6px}
    .stat{flex:1 1 160px; padding:12px;border:1px solid var(--line);border-radius:14px;background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01))}
    .stat strong{font-size:22px;display:block;line-height:1}
    .stat span{font-size:12px;color:var(--muted)}

    .toast{position:fixed;left:50%;bottom:24px;translate:-50% 20px;opacity:0;background:linear-gradient(180deg, var(--card), var(--card-2));
      border:1px solid var(--line);border-radius:14px;padding:10px 14px;font-weight:600;box-shadow:0 12px 40px rgba(0,0,0,.35);z-index:9999;transition:opacity .25s ease, translate .25s ease}
    .toast.show{opacity:1;translate:-50% 0}

    .ripple{position:absolute;border-radius:50%;inset:auto; pointer-events:none;transform:translate(-50%,-50%); width:6px;height:6px;opacity:.35;background:white; mix-blend-mode:overlay; filter:blur(.5px);animation:ripple .6s ease-out forwards}
    @keyframes ripple{ to{ opacity:0; width:220px; height:220px } }

    
    

    /* Aper√ßu modal */
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.5);opacity:0;pointer-events:none;transition:opacity .2s ease}
    .overlay.show{opacity:1;pointer-events:auto}
    .modal{position:fixed;left:50%;top:50%;translate:-50% -50%;width:min(720px,calc(100vw - 24px));max-height:80vh;overflow:auto;background:linear-gradient(180deg, var(--card), var(--card-2));border:1px solid var(--line);border-radius:16px;padding:14px;box-shadow:0 30px 80px rgba(0,0,0,.5);opacity:0;scale:.98;transition:opacity .2s ease, scale .2s ease}
    .overlay.show .modal{opacity:1;scale:1}

    /* T√©moignages mini */
    .testis{display:flex;gap:10px;overflow:auto;padding-bottom:8px}
    .tcard{min-width:220px;border:1px solid var(--line);border-radius:14px;padding:10px;background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01))}
    .tcard strong{display:block}

    @media (prefers-reduced-motion: reduce){ .card,.btn,.accent-underline,.modal{ transition:none } .card:hover{ transform:none } .ripple{ display:none } }
  
    /* --- Optimisations mobile-first --- */
    @media (max-width: 540px){
      .container{padding:12px}
      header{align-items:flex-start}
      .brand{gap:10px}
      .logo{width:42px;height:42px;border-radius:12px;font-size:22px}
      .title{font-size:24px}
      .subtitle{font-size:13px}
      .hero{padding:14px;border-radius:16px;margin:8px 0 14px}
      .cards{gap:10px}
      .panel{padding:14px}
      .stats{display:grid;grid-template-columns:1fr 1fr}
      .stat strong{font-size:20px}
      .features{gap:6px}
      .pill{padding:6px 8px;font-size:12px}
      .toolbar{flex-direction:column}
      .btn,.btn-lg{width:100%}
      .testis{gap:8px;padding-bottom:6px;scroll-snap-type:x mandatory}
      .tcard{min-width:82%;scroll-snap-align:start}
      
      
      .overlay .modal{width:calc(100vw - 16px);max-height:80vh}
      #resume{max-width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    }

    /* R√©duction des effets 3D sur appareils tactiles */
    @media (hover: none){
      .tilt{transform:none !important}
      .tilt:hover{transform:none}
    }

    /* --- Header index r√©organis√© (3 lignes) --- */
.site-header{
  display:flex;flex-direction:column;gap:8px;margin-bottom:16px
}
.site-header .topbar{
  display:flex;align-items:center;justify-content:space-between;gap:12px;
  padding:10px 12px;border:1px solid var(--line);border-radius:16px;
  background:linear-gradient(180deg, var(--card), var(--card-2));
  box-shadow:0 8px 30px rgba(0,0,0,.12), inset 0 1px 0 rgba(255,255,255,.02);
}
.site-header .brand{display:flex;align-items:center;gap:12px;min-width:0}
.site-header .brand-text{min-width:0}
.site-header .title{font-size:clamp(22px,5vw,32px);font-weight:900;line-height:1.1}
.site-header .subtitle{color:var(--muted);padding-left:4px}

.top-actions{display:flex;align-items:center;gap:10px}
#resume{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:60vw}

@media (max-width:540px){
  .site-header{gap:6px;margin-bottom:12px}
  .site-header .topbar{padding:10px;border-radius:14px}
  .site-header .title{font-size:24px}
  .site-header .subtitle{font-size:13px}
  #resume{max-width:52vw}
}

  </style>
</head>
<body>
  <div class="container">
<header class="site-header">
  <div class="topbar">
    <div class="brand">
      <div class="logo" aria-hidden="true">üêª</div>
      <div class="brand-text">
        <div class="title">Auto √âcole Nounours ‚Äì Permis Moto</div>
      </div>
    </div>

    <div class="top-actions">
      <span class="pill" id="resume" hidden>üîÅ Reprendre : <strong id="lastModeLabel">‚Äì</strong></span>
        <span class="knob" aria-hidden="true"></span>
      </span>
    </div>
  </div>

  <div class="subtitle">Choisissez votre mode et d√©marrez en confiance.</div>
</header>


    <!-- HERO -->
    <section class="hero tilt" aria-label="Accroche">
      <div class="bgfx" aria-hidden="true"></div>
      <h1>üöÄ Entra√Ænez-vous comme √† l‚Äôexamen, progressez question apr√®s question.</h1>
      <div class="accent-underline" id="underline"></div>
      <div class="features" aria-label="Points forts">
        <span class="pill"><span class="ok">‚úì</span> Corrections claires</span>
        <span class="pill"><span class="ok">‚úì</span> Chronom√®tre r√©aliste</span>
        <span class="pill"><span class="ok">‚úì</span> Reprise instantan√©e</span>
        <span class="pill"><span class="ok">‚úì</span> Raccourcis <kbd>E</kbd>/<kbd>T</kbd></span>
      </div>
      <div class="stats" role="list" aria-label="Chiffres cl√©s">
        <div class="stat" role="listitem"><strong data-count="40">0</strong><span>questions par s√©rie</span></div>
        <div class="stat" role="listitem"><strong data-count="7">0</strong><span>th√®mes essentiels</span></div>
        <div class="stat" role="listitem"><strong data-count="100">0</strong><span>% gratuit et illimit√©</span></div>
      </div>

      <div class="testis" aria-label="Avis d‚Äô√©l√®ves">
        <div class="tcard"><strong>‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è</strong><span class="subtitle">‚ÄúOn se sent pr√™ts pour l‚Äôexamen !‚Äù ‚Äî L√©a</span></div>
        <div class="tcard"><strong>‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è</strong><span class="subtitle">‚ÄúCorrections ultra p√©dagogiques.‚Äù ‚Äî Karim</span></div>
        <div class="tcard"><strong>‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è</strong><span class="subtitle">‚ÄúDesign motivant, top üëç‚Äù ‚Äî Emma</span></div>
      </div>
    </section>

    <div class="cards">
      <!-- Carte EXAMEN -->
      <section class="card tilt" aria-label="Examen blanc">
        <div class="panel">
          <div class="pill muted" style="margin-bottom:8px">üéØ Objectif : conditions r√©elles</div>
          <h2 style="margin:0">Examen blanc ‚Äì 40 questions</h2>
          <p class="subtitle" style="margin:6px 0 12px">R√©sultats √† la fin. Id√©al pour √©valuer votre niveau.</p>
          <div class="toolbar">
            <a class="btn btn-primary btn-lg cta" data-mode="exam" href="quiz.html?mode=exam" aria-describedby="examHelp">
              <span aria-hidden="true">üèÅ</span> Commencer l‚Äôexamen blanc
            </a>
            <button class="btn btn-lg preview" data-target="exam" type="button" aria-label="Pr√©visualiser l‚Äôexamen">üëÄ Aper√ßu</button>
            <span id="examHelp" class="subtitle" style="display:block;text-align:center">Raccourci : <kbd>E</kbd></span>
          </div>
        </div>
      </section>

      <!-- Carte ENTRA√éNEMENT -->
      <section class="card tilt" aria-label="Entra√Ænement">
        <div class="panel">
          <div class="pill muted" style="margin-bottom:8px">üß≠ Objectif : apprendre en progressant</div>
          <h2 style="margin:0">Entra√Ænement ‚Äì 40 questions</h2>
          <p class="subtitle" style="margin:6px 0 12px">Corrections au fil des questions, explications et astuces.</p>
          <div class="toolbar">
            <a class="btn btn-primary btn-lg cta" data-mode="training" href="quiz.html?mode=training" aria-describedby="trainHelp">
              <span aria-hidden="true">üí™</span> Commencer l‚Äôentra√Ænement
            </a>
            <button class="btn btn-lg preview" data-target="training" type="button" aria-label="Pr√©visualiser l‚Äôentra√Ænement">üëÄ Aper√ßu</button>
            <span id="trainHelp" class="subtitle" style="display:block;text-align:center">Raccourci : <kbd>T</kbd></span>
          </div>
        </div>
      </section>
    </div>
  </div>

  <!-- Toast ARIA -->
  <div class="toast" role="status" aria-live="polite" id="toast" aria-atomic="true"></div>

  <!-- Modale d‚Äôaper√ßu -->
  <div class="overlay" id="overlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <h3 id="modalTitle" style="margin:6px 0 10px">Aper√ßu</h3>
      <div class="subtitle" id="modalDesc">‚Äî</div>
      <div id="previewContent" style="margin-top:10px"></div>
      <div class="toolbar" style="margin-top:12px">
        <button class="btn" id="closePreview" type="button">Fermer</button>
      </div>
    </div>
  </div>

  <canvas id="fx" width="0" height="0" style="position:fixed;inset:0;pointer-events:none;"></canvas>

  <script>
    // Accent underline
    window.addEventListener('load', () => {
      const u = document.getElementById('underline');
      if (u) u.style.width = '180px';
    });

    // Simple 3D tilt on mouse move (disabled on touch devices)
    (function initTilt(){
      if (matchMedia('(hover: none)').matches) return;
      const tilts = document.querySelectorAll('.tilt');
      tilts.forEach(el => {
        el.addEventListener('pointermove', e => {
          const r = el.getBoundingClientRect();
          const x = (e.clientX - r.left) / r.width - 0.5;
          const y = (e.clientY - r.top) / r.height - 0.5;
          el.style.transform = `rotateY(${x*6}deg) rotateX(${-y*6}deg) translateY(-2px)`;
        });
        el.addEventListener('pointerleave', () => { el.style.transform = ''; });
      });
    })();

    // Count up stats when visible
    (function initCounters(){
      const counters = document.querySelectorAll('[data-count]');
      const onVisible = (el, cb) => {
        const io = new IntersectionObserver((entries) => {
          if (entries[0].isIntersecting) { cb(); io.disconnect(); }
        }, { threshold: 0.4 });
        io.observe(el);
      };
      counters.forEach(el => {
        onVisible(el, () => {
          const target = +el.dataset.count;
          const dur = 900, t0 = performance.now();
          const step = (now) => {
            const p = Math.min(1, (now - t0) / dur);
            el.textContent = Math.round(target * (0.2 + 0.8 * p));
            if (p < 1) requestAnimationFrame(step); else el.textContent = target;
          };
          requestAnimationFrame(step);
        });
      });
    })();

    // Theme toggle (persist)
    (function initTheme(){
      const THEME_KEY = 'nounours:theme';
      const sw = document.getElementById('themeSwitch');
      if (!sw) return;
      const setTheme = (on) => {
        document.documentElement.dataset.theme = on ? 'light' : 'auto';
        sw.dataset.on = on ? '1' : '0';
        localStorage.setItem(THEME_KEY, on ? 'light' : 'auto');
      };
      setTheme(localStorage.getItem(THEME_KEY) === 'light');
      const toggle = () => setTheme(!(sw.dataset.on === '1'));
      sw.addEventListener('click', toggle);
      sw.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggle(); } });
    })();

    // Last mode memory + resume pill
    (function initResume(){
      const LAST_KEY = 'nounours:lastMode';
      const label = { exam: 'Examen blanc', training: 'Entra√Ænement' };
      const resume = document.getElementById('resume');
      const lastMode = localStorage.getItem(LAST_KEY);
      if (resume && lastMode && label[lastMode]){
        document.getElementById('lastModeLabel').textContent = label[lastMode];
        resume.hidden = false;
        resume.style.cursor = 'pointer';
        resume.title = 'Cliquez pour reprendre';
        resume.addEventListener('click', () => { location.href = `quiz.html?mode=${lastMode}`; });
      }
    })();

    // Keyboard shortcuts
    (function initShortcuts(){
      const go = (mode) => { location.href = `quiz.html?mode=${mode}`; };
      window.addEventListener('keydown', (e) => {
        const tag = (e.target && e.target.tagName) || '';
        if (/INPUT|TEXTAREA|SELECT/.test(tag)) return;
        const k = e.key.toLowerCase();
        if (k === 'e') go('exam');
        if (k === 't') go('training');
      });
    })();

    // Toast helper
    function toast(msg){
      const t = document.getElementById('toast');
      if (!t) return;
      t.textContent = msg;
      t.classList.add('show');
      clearTimeout(toast._id);
      toast._id = setTimeout(() => t.classList.remove('show'), 1600);
    }

    // Ripple + confetti + save last mode on CTA click
    (function initCtas(){
      const LAST_KEY = 'nounours:lastMode';
      document.querySelectorAll('.cta').forEach(btn => {
        btn.addEventListener('click', (e) => {
          // ripple
          const r = document.createElement('span');
          r.className = 'ripple';
          const rect = btn.getBoundingClientRect();
          r.style.left = (e.clientX - rect.left) + 'px';
          r.style.top  = (e.clientY - rect.top) + 'px';
          btn.appendChild(r);
          setTimeout(() => r.remove(), 650);
          // save + toast + confetti
          const mode = btn.dataset.mode;
          if (mode) {
            localStorage.setItem(LAST_KEY, mode);
            toast(mode === 'exam' ? 'Bonne chance ! üèÅ' : 'C‚Äôest parti ! üí™');
          }
          confettiBurst(e.clientX, e.clientY);
        }, { passive: true });
      });
    })();

    // Simple confetti
    const canvas = document.getElementById('fx');
    const ctx = canvas.getContext('2d');
    function setSize(){ canvas.width = innerWidth * devicePixelRatio; canvas.height = innerHeight * devicePixelRatio; }
    setSize(); window.addEventListener('resize', setSize);
    function confettiBurst(x, y){
      const pr = devicePixelRatio || 1;
      const origin = { x: x*pr, y: y*pr };
      const colors = ['#ffffff','#fde68a','#f59e0b','#f97316','#34d399','#60a5fa'];
      const parts = Array.from({length: 40}, (_,i)=>({
        x: origin.x, y: origin.y,
        vx: (Math.random()*2-1)*3*pr,
        vy: (-Math.random()*2-0.5)*4*pr,
        g: 0.18*pr, life: 700+Math.random()*300,
        size: 2+Math.random()*3, rot: Math.random()*6.28,
        color: colors[(i+Math.floor(Math.random()*colors.length))%colors.length]
      }));
      const t0 = performance.now();
      const draw = (now) => {
        const dt = Math.min(32, now - (draw._last||now));
        draw._last = now;
        ctx.clearRect(0,0,canvas.width,canvas.height);
        let alive = false;
        for(const p of parts){
          p.vy += p.g; p.x += p.vx; p.y += p.vy;
          p.rot += 0.12; p.life -= dt; if(p.life>0) alive = true;
          ctx.save(); ctx.translate(p.x, p.y); ctx.rotate(p.rot);
          ctx.globalAlpha = Math.max(0, p.life/1000);
          ctx.fillStyle = p.color; ctx.fillRect(-p.size, -p.size, p.size*2, p.size*2);
          ctx.restore();
        }
        if(alive && now - t0 < 1200){ requestAnimationFrame(draw); }
        else { ctx.clearRect(0,0,canvas.width,canvas.height); }
      };
      requestAnimationFrame(draw);
    }

    // Preview modal
    (function initPreview(){
      const overlay = document.getElementById('overlay');
      const previewContent = document.getElementById('previewContent');
      const closeBtn = document.getElementById('closePreview');
      function openPreview(mode){
        document.getElementById('modalTitle').textContent = mode==='exam' ? 'Aper√ßu ‚Äî Examen blanc' : 'Aper√ßu ‚Äî Entra√Ænement';
        document.getElementById('modalDesc').textContent = mode==='exam' ? 'Compte √† rebours, 40 questions, r√©sultats √† la fin.' : 'Corrections instantan√©es, explications d√©taill√©es.';
        previewContent.innerHTML = renderPreview(mode);
        overlay.classList.add('show');
        overlay.setAttribute('aria-hidden','false');
        closeBtn.focus();
      }
      function closePreview(){
        overlay.classList.remove('show');
        overlay.setAttribute('aria-hidden','true');
      }
      if (closeBtn) closeBtn.addEventListener('click', closePreview);
      if (overlay) overlay.addEventListener('click', (e)=>{ if(e.target===overlay) closePreview(); });
      window.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && overlay.classList.contains('show')) closePreview(); });
      document.querySelectorAll('.preview').forEach(b=> b.addEventListener('click', ()=> openPreview(b.dataset.target)));
    })();

    function renderPreview(mode){
      const time = mode==='exam' ? '<div class="pill warn">‚è± 30 min</div>' : '<div class="pill ok">üí° Explications activ√©es</div>';
      const sample = [
        {q:'√Ä l‚Äôapproche d‚Äôun passage pi√©ton masqu√© par un v√©hicule, que dois-je faire ?', a:['Je ralentis et me tiens pr√™t √† m‚Äôarr√™ter','Je klaxonne et je passe','J‚Äôacc√©l√®re pour d√©gager vite'], c:0},
        {q:'Sur route mouill√©e, la distance de freinage est‚Ä¶', a:['R√©duite','Multipli√©e par 2','Inchang√©e'], c:1},
        {q:'Un panneau triangulaire bord√© de rouge indique‚Ä¶', a:['Une obligation','Un danger','Une indication de service'], c:1}
      ];
      const items = sample.map((s,i)=>`<div style="margin:8px 0;padding:10px;border:1px solid var(--line);border-radius:12px"><strong>Q${i+1}.</strong> ${s.q}<div style="display:flex;flex-direction:column;gap:6px;margin-top:8px">${s.a.map((t)=>`<label class=\"btn\" style=\"justify-content:flex-start\"><input type=\"radio\" name=\"q${i}\" style=\"margin-right:8px\"> ${t}</label>`).join('')}</div></div>`).join('');
      return `<div style="display:flex;align-items:center;justify-content:space-between;gap:10px">${time}<div class="subtitle">3 questions d‚Äôexemple</div></div>${items}`;
    }

    
  </script>
</body>
</html>
